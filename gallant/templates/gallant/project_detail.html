{% extends "base_body.html" %}
{% load bootstrap i18n gallant_tags static %}

{% block section_title %}
    {% trans "Project" %}
{% endblock %}

{% block scripts %}
    {{ block.super }}
    <script src="{% static "js/angular.js" %}"></script>
    <script src="{% static "js/angular-resource.js" %}"></script>
    <script src="{% static "js/ui-bootstrap-tpls.js" %}"></script>
    <script src="{% static "djng/js/django-angular.min.js" %}"></script>
    <script src="{% static "js/ng-sortable.js" %}"></script>

    {% if DEBUG %}
        <script src="{% static "js/gallant.js" %}"></script>
        <script src="{% static "js/kanban.js" %}"></script>
    {% else %}
        <script src="{% static "js/all.min.js" %}"></script>
    {% endif %}
{% endblock %}

{% block css %}
    {{ block.super }}

    <link rel="stylesheet" href="{% static "css/ng-sortable.style.min.css" %}">
    <link rel="stylesheet" href="{% static "css/ng-sortable.min.css" %}">

{% endblock %}

{% block extra_wrapper_attrs %} ng-app="glProjectDetail" {% endblock %}

{% block content %}
<div ng-controller="glProjectDetailController"
     ng-init="init('{% url 'service_detail' object.id %}', {{ object.id }})">
    <div class="row">
        <div class="col-lg-10 col-md-10 col-sm-9 col-xs-9">
            <h2 class="section_title">{{ object.name }}</h2>
        </div>
        <div class="col-lg-2 col-md-2 col-sm-3 col-xs-3 action_box">
            <a href="{% url 'edit_project' object.id %}" class="edit_button" id="edit_project" title="{% trans "Edit" %}">
                <button id="section_edit" type="button" class="btn btn-default edit_button btn-add" aria-label="Edit">
                    <span class="glyphicon glyphicon-edit"/>
                </button>
            </a>
            <a href="{% url 'delete_project' object.id %}" class="delete_button" title="{% trans "Delete" %}" onclick="return confirm('{% trans "Are you sure? This will also delete all links between the project and its linked quotes." %}')"> 
                <button id="section_delete" type="button" class="btn btn-default delete_button btn-add" aria-label="Delete"> 
                    <span class="glyphicon glyphicon-trash"/> 
                </button>
            </a> 
        </div>
    </div>


    <div class="row object_data">
        <div class="col-lg-6">
            <p><span class="label label-default">{{ object.get_status_display }}</span></p>
            <br>
        </div>
        <div class="col-lg-6">
        </div>

    </div>

    <hr>

    <h2 class="section_title">Deliverables</h2>
    <div ng-include src="'{% static "gallant/html/gl_service_board.html" %}'">
    </div>
    <hr>

    {% if brief in briefs %}

        <hr>
        <div id="briefs">
            <h2 class="section_title">
                {% trans "Project Briefs" %}
            </h2>

            <hr>

            {% objects_for object.quote.brief_set as briefs %}
            {% for brief in briefs %}
                <div class="brief_link">
                    <a href="{% url 'brief_detail' brief.id %}?project_id={{ object.id }}">{{ brief }} </a>&mdash;
                    {{ brief.modified|date:'Y-m-d H:i' }}
                </div>
            {% endfor %}
        </div>
        <hr>

    {% endif %}

    <div id="notes">

        <h2 class="section_title">
            {% trans "Project Notes" %}
        </h2>

        <hr>

        {% objects_for object.notes as notes %}
        {% for item in notes %}
            {% include "gallant/note.html" %}
        {% endfor %}
        <div>
            {% include "gallant/add_note.html" %}
        </div>
    </div>
</div>
{% endblock %}