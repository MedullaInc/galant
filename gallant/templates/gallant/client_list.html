{% extends 'base_body.html' %}
{% load bootstrap i18n static %}

{% block scripts %}
    {{ block.super }}
    <script src="{% static "js/angular.js" %}"></script>
    <script src="{% static "js/angular-resource.js" %}"></script>
    <script src="{% static "js/angular-animate.js" %}"></script>
    <script src="{% static "js/smart-table.js" %}"></script>
    <script src="{% static "js/ng-country-select.min.js" %}"></script>
    <script src="{% static "djng/js/django-angular.min.js" %}"></script>
    <script src="{% static "js/ui-bootstrap-tpls.js" %}"></script>
    <script src="{% static "js/ng-sortable.js" %}"></script>
    <script src="{% static "djng/js/django-angular.min.js" %}"></script>

    {% if DEBUG %}
        <script src="{% static "js/quotes.js" %}"></script>
        <script src="{% static "js/gallant.js" %}"></script>
        <script src="{% static "js/kanban.js" %}"></script>
    {% else %}
        <script src="{% static "js/all.min.js" %}"></script>
    {% endif %}

{% endblock %}

{% block css %}
    {{ block.super }}

    <link rel="stylesheet" href="{% static "css/ng-sortable.style.min.css" %}">
    <link rel="stylesheet" href="{% static "css/ng-sortable.min.css" %}">

{% endblock %}

{% block extra_wrapper_attrs %} ng-app="glClientList" {% endblock %}

{% block messages %}
    <div gl-alerts></div>
    {{ block.super }}
{% endblock %}

{% block page_title %}
    {% trans "Clients" %}
{% endblock %}

{% block content %}
    <div ng-controller="glClientListController" ng-init="init('{% url 'client_detail' %}')">
    <div class="row">
        <div class="col-lg-12">

            <div class="row">
                <div class="col-lg-6">
                    <div class="pull-left">
                        <div gl-add-modal open-fn="addClient" title="Add Client" modal-instance="modalInstance">
                            <div gl-client-add on-success="clientSaved"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="pull-right">
                        <button class="btn btn-default btn-add" id="show_client_list" ng-click="showList=true">
                            <span class="glyphicon glyphicon-align-justify"></span>
                        </button>
                        <button class="btn btn-default btn-add" id="show_client_board" ng-click="showList=false">
                            <span class="glyphicon glyphicon-th"></span>
                        </button>
                        <button id="client_add" type="button" class="btn btn-default btn-add action-button pull-right"
                                ng-click="addClient()">
                            <span class="glyphicon glyphicon-plus"></span>
                            {% trans "Add Client" %}
                        </button>
                    </div>
                </div>
            </div>
            <br/>
            <div ng-show="!showList">
                <div ng-include src="'{% static "gallant/html/gl_client_board.html" %}'">
                </div>
            </div>
            <div class="row" ng-show="showList">
                <div class="col-lg-12">
                    <br/>

                    <table st-table="clients" st-safe-src="clientsSafe"
                           class="table table-striped table-bordered col-lg-12">
                        <thead>
                        <tr>
                            <th colspan="5" class="container">
                                <div class="row">
                                    <label class="control-label search col-lg-12">Search</label>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <input type="text" placeholder="Search Client Name"
                                               st-search="name" class="form-control medium-text"/>

                                    </div>
                                    <div class="col-lg-6">
                                        <input type="text" placeholder="Search Client Status"
                                               st-search="status" class="form-control medium-text"/>

                                    </div>
                                </div>
                            </th>
                        </tr>
                        <tr>
                            <th st-sort="name">{% trans "Name" %}</th>
                            <th st-sort="company">{% trans "Company" %}</th>
                            <th st-sort="money_owed.amount">{% trans "$ Owed" %}</th>
                            <th st-sort="flags">{% trans "Status" %}</th>
                        </tr>
                        </thead>
                        <tbody ng-include src="'{% static "gallant/html/gl_client_rows.html" %}'">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block extra_body %}
    <script>
        $('.table > tbody > tr').click(function () {
            window.location.href = "{% url 'client_detail' %}" + $(this).attr('data-rel')
        });
    </script>
{% endblock %}