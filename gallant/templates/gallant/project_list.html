{% extends "base_sidebar.html" %}
{% load bootstrap i18n %}

{% block section_title %}
    {% trans "Projects" %}
{% endblock %}

{% block sidebar %}
    <a>
        <button id="add_project_button" type="button" class="btn btn-default sidebar">
            {% trans "Add New Project" %}
        </button>
    </a>
{% endblock %}

{% block center_content %}
    <table class="table table-striped table-bordered">
        <thead>
        <th>{% trans "Name" %}</th>
        <th>{% trans "Status" %}</th>
        <th>{% trans "Client" %}</th>
        </thead>
        {% for project in object_list %}
            <tr data-rel="{{ project.id }}" style="cursor: pointer">
                <td>{{ project.name }}</td>
                <td>{{ project.get_status_display }}</td>
                <td>{{ project.quote.client }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4">
                    No projects yet.
                </td>
            </tr>
        {% endfor %}
    </table>
{% endblock %}

{% block extra_body %}
    <div id="quote_select" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h2 class="section_title">Select Quote</h2>
                </div>
                <div class="modal-body" style="height: 500px; overflow: auto;">
                    {% with object_list=quote_list %}
                        {% include "quotes/quote_table.html" %}
                    {% endwith %}
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>
    <script>
        $('#add_project_button').click(function () {
            $('#quote_select').modal('show');
        });
        
        $('.table > tbody > tr').click(function () {
            window.location.href = "{% url 'project_detail' %}" + $(this).attr('data-rel')
        });

        $('.table .quote_row').click(function (e) {
            window.location.href = "{% url 'add_project' %}" + $(this).attr('data-rel');
        });
    </script>
{% endblock %}