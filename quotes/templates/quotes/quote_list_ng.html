{% extends "base_sidebar.html" %}
{% load bootstrap i18n %}
{% load static %}

{% block ng_app %} ng-app="quote" {% endblock %}

{% block scripts %}
    {{ block.super }}
    <script src="{% static "js/angular.js" %}"></script>
    <script src="{% static "js/angular-resource.js" %}"></script>
    <script src="{% static "js/xeditable/xeditable.min.js" %}"></script>
    <script src="//angular-ui.github.io/bootstrap/ui-bootstrap-tpls-0.14.3.js"></script>
    <script src="{% static "djangular/js/django-angular.min.js" %}"></script>
    <script src="{% static "gallant/js/directives/glForm.js" %}"></script>
    <script src="{% static "gallant/js/controllers/glFormController.js" %}"></script>
    <script src="{% static "quotes/js/controllers/qtPopoverController.js" %}"></script>
    <script src="{% static "quotes/js/services/qtServices.js" %}"></script>
    <script src="{% static "quotes/js/directives/qtForm.js" %}"></script>
    <script src="{% static "quotes/js/directives/qtList.js" %}"></script>
    <script src="{% static "quotes/js/directives/qtTemplateList.js" %}"></script>
    <script src="{% static "quotes/js/apps/quotes.js" %}"></script>
    <script src="{% static "js/ng-sortable/ng-sortable.min.js" %}"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.7/angular-animate.js"></script>



{% endblock %}

{% block section_title %}
    {% trans "Quotes" %}
{% endblock %}

{% block sidebar %}
    <div ng-controller="qtPopoverController">
        <a>
            <button popover-placement="bottom" uib-popover-template="dynamicPopover.templateUrl" type="button" class="btn btn-default sidebar">{% trans "Add New Quotes" %}</button>
        </a>

        <a href="{% url 'quote_templates' %}">
            <button type="button" class="btn btn-default sidebar">
                {% trans "Templates" %}
            </button>
        </a>
    </div>

{% endblock %}

{% block center_content %}
    <div ng-controller="glFormController"
         ng-init="init('{% firstof language LANGUAGE_CODE %}', '{{ csrf_token }}')">
        <div qt-quote-list quote-id="{{ object.pk }}" quote="object" endpoint="objectEndpoint"
             language="currentLanguage" forms="forms"
             client-id="{{ client.id }}" project-id="{{ project.id }}" quote-id="{{ quote.id }}"
             template-id="{{ template_id }}">
        </div> 
    </div>

{% endblock %}

{% block extra_body %}

    <script type="text/ng-template" id="myPopoverTemplate.html">
        <a class="from_template_button" ng-click="open()">
            <button type="button" class="btn btn-default from_template_button sidebar">From Template</button>
        </a>
        <a ng-click="goToUrl('{% url 'add_quote' %}')">
            <button type="button" class="btn btn-default from_scratch_button sidebar">From Scratch</button>
        </a>
    </script>

    <script type="text/ng-template" id="myModalContent.html">
        <div class="modal-body">
            <div ng-controller="glFormController"
                 ng-init="init('{% firstof language LANGUAGE_CODE %}', '{{ csrf_token }}')">
                <div qt-quote-template-list quote-id="{{ object.pk }}" quote="object" endpoint="objectEndpoint"
                     language="currentLanguage" forms="forms"
                     client-id="{{ client.id }}" project-id="{{ project.id }}" quote-id="{{ quote.id }}"
                     template-id="{{ template_id }}" addquoteurl="'{% url 'add_quote' %}'">
                </div> 
            </div>
        </div>
    </script>

{% endblock %}