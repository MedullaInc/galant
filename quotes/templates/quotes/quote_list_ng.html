{% extends "base_sidebar.html" %}
{% load bootstrap i18n %}
{% load static %}

{% block ng_app %} ng-app="quote" {% endblock %}

{% block scripts %}
    {{ block.super }}
    <script src="{% static "js/angular.js" %}"></script>
    <script src="{% static "js/angular-resource.js" %}"></script>
    <script src="{% static "js/angular-animate.js" %}"></script>
    <script src="{% static "js/xeditable.min.js" %}"></script>
    <script src="{% static "js/ui-bootstrap-tpls.js" %}"></script>
    <script src="{% static "js/ng-sortable.min.js" %}"></script>
    <script src="{% static "js/smart-table.js" %}"></script>
    <script src="{% static "djng/js/django-angular.min.js" %}"></script>
    <script src="{% static "js/gallant.js" %}"></script>
    <script src="{% static "js/quotes.js" %}"></script>
{% endblock %}

{% block section_title %}
    {% trans "Quotes" %}
{% endblock %}

{% block sidebar %}
    <div ng-controller="qtPopoverController"
         ng-init="init('{% url 'add_quote' %}', '{% firstof language LANGUAGE_CODE %}')">
        <a>
            <button popover-placement="bottom" uib-popover-template="dynamicPopover.templateUrl" type="button" class="btn btn-default sidebar btn-side" popover-trigger="focus">{% trans "Add New Quote" %}</button>
        </a>

        <a href="{% url 'quotetemplates' %}">
            <button type="button" class="btn btn-default sidebar btn-side">
                {% trans "Templates" %}
            </button>
        </a>
    </div>

{% endblock %}

{% block center_content %}
    {% if client %}
        <h2 class="center_title">
            {{ client }}
            <span class="pull-right glyphicon glyphicon-question-sign help-tooltip" uib-tooltip="Shows client's quotes. You can create one from scratch or from a template. You can also create one and save it as a template for later use." tooltip-placement="top-right"></span>
        </h2>
    {% endif %}
    <div ng-controller="qtQuoteListController">
    <div ng-init="init('{% url 'quote_detail' %}', '{% firstof language LANGUAGE_CODE %}', {% firstof client.id 'null' %})">

        <div class="row">

            <div class="col-lg-12">

                <table st-table="quotes" st-safe-src="quotesSafe"
                       class="table table-striped table-bordered col-lg-12">
                    <thead>
                    <tr>
                        <th colspan="4" class="container">
                            <div class="row">
                                <label class="control-label search col-lg-12">Search</label>
                            </div>
                            <div class="row">
                                <div class="col-lg-12">
                                    <input type="text" placeholder="Search Quote Name" st-search="name" class="form-control medium-text"/>
                                </div>
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <th st-sort="last_modified">{% trans "Last Modified" %}</th>
                        <th st-sort="client_name">{% trans "Client" %}</th>
                        <th st-sort="name">{% trans "Quote" %}</th>
                        <th st-sort="status">{% trans "Status" %}</th>
                    </tr>
                    </thead>
                    <tbody ng-include src="'{% static "quotes/html/qt_quote_rows.html" %}'">
                    </tbody>
                </table>

            </div>

        </div>

    </div>
{% endblock %}

{% block extra_body %}

    <div ng-init="init('{% url 'quote_detail' %}', {{ LANGUAGE_CODE }})">
        <script type="text/ng-template" id="addQuotePopoverTemplate.html">
            <a class="from_template_button" ng-click="open()">
                <button type="button" class="btn btn-default from_template_button sidebar">From Template</button>
            </a>
            <a ng-click="addQuoteRedirect()">
                <button type="button" class="btn btn-default from_scratch_button sidebar">From Scratch</button>
            </a>
        </script>
        <script type="text/ng-template" id="myModalContent.html">
            <div class="modal-header">
                <h2 class="section_title">Select Template</h2>
            </div>
            <div class="modal-body">
                <table st-table="quoteTemplate" class="table table-striped table-bordered">
                    <thead>
                    <tr>
                        <th st-sort="name">{% trans "Name" %}</th>
                        <th st-sort="date">{% trans "Date" %}</th>
                        <th st-sort="language">{% trans "Language" %}</th>
                    </tr>
                    </thead>
                    <tbody ng-include src="'{% static "quotes/html/qt_quotetemplate_modal_rows.html" %}'"></tbody>
                </table>
            </div>
        </script>
    </div>
    </div>

{% endblock %}