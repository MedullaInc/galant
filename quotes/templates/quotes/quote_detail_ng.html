{% extends "base_sidebar_enclosed.html" %}
{% load bootstrap i18n %}
{% load static %}

{% block scripts %}
    {{ block.super }}
    <script src="{% static "js/angular.js" %}"></script>
    <script src="{% static "js/angular-resource.js" %}"></script>
    <script src="{% static "js/xeditable/xeditable.min.js" %}"></script>
    <script src="{% static "js/ui-bootstrap-tpls.js" %}"></script>
    <script src="{% static "djangular/js/django-angular.min.js" %}"></script>
    <script src="{% static "gallant/js/directives/glForm.js" %}"></script>
    <script src="{% static "gallant/js/controllers/glFormController.js" %}"></script>
    <script src="{% static "quotes/js/services/qtServices.js" %}"></script>
    <script src="{% static "quotes/js/directives/qtForm.js" %}"></script>
    <script src="{% static "quotes/js/directives/qtList.js" %}"></script>
    <script src="{% static "quotes/js/apps/quotes.js" %}"></script>
    <script src="{% static "js/ng-sortable/ng-sortable.min.js" %}"></script>
{% endblock %}

{% block css %}
    <link rel="stylesheet" href="{% static "css/xeditable/xeditable.css" %}">
    <link rel="stylesheet" href="{% static "css/ng-sortable/ng-sortable.style.min.css" %}">
    <link rel="stylesheet" href="{% static "css/ng-sortable/ng-sortable.min.css" %}">


    <style>
        [name="name"]{
           width: 110px;
        }
        [name="quantity"]{
           width: 70px;
        }
        [name="amount"]{
           width: 70px;
        }
    </style>
    <style>
    
    .list {
        list-style: none outside none;
        margin: 10px 0 30px;
    }

    .item {
        width: 200px;
        padding: 5px 10px;
        margin: 5px 0;
        border: 2px solid #444;
        border-radius: 5px;
        background-color: #EA8A8A;

        font-size: 1.1em;
        font-weight: bold;
        text-align: center;
        cursor: move;
    }


    /***  Extra ***/



    .logList {
        margin-top: 20px;
        width: 250px;
        min-height: 200px;
        padding: 5px 15px;
        border: 5px solid #000;
        border-radius: 15px;
    }

    .logList:before {
        content: 'log';
        padding: 0 5px;
        position: relative;
        top: -1.1em;
        background-color: #FFF;
    }


    </style>

{% endblock %}

{% block section_title %}
    {% trans "Quote" %}
{% endblock %}

{% block sidebar %}

    {% if object.client.email and object.status == '1' %}
        <form method="post">
            {% csrf_token %}
            <a>
                <button type="submit" class="btn btn-default sidebar" id="send_quote">
                    {% trans "Send to Client" %}
                </button>
            </a>
        </form>
    {% endif %}

    <a href="{% url 'quote_pdf' object.id %}">
        <button type="button" class="btn btn-default sidebar">
            {% trans "Download Quote" %}
        </button>
    </a>
    <a href="{% url 'add_quote_template' quote_id=object.id %}">
        <button type="button" class="btn btn-default sidebar" title="Create template from this quote.">
            {% trans "Use as Template" %}
        </button>
    </a>
{% endblock %}

{% block center_content %}

    <div class="row">
        <div class="col-lg-10 col-md-10 col-sm-9 col-xs-9">
            <h2 class="section_title">{{ object.name }}</h2>
        </div>
        <div class="col-lg-2 col-md-2 col-sm-3 col-xs-3 action_box">
            <a href="{% url 'edit_quote' object.id %}" class="edit_button" title="{% trans "Edit" %}">
                <button id="section_edit" type="button" class="btn btn-default edit_button" aria-label="Edit">
                    <span class="glyphicon glyphicon-edit"/>
                </button>
            </a>
            <a href="{% url 'delete_quote' object.id %}" class="delete_button" title="{% trans "Delete" %}" onclick="return confirm('{% trans "Are you sure?" %}')"> 
                <button id="section_delete" type="button" class="btn btn-default delete_button" aria-label="Delete"> 
                    <span class="glyphicon glyphicon-trash"/> 
                </button>
            </a> 
        </div>
    </div>

    <div class="row object_data">
        <div class="col-lg-6">
            <p id="client" class="data"><span class="detail_title">{% trans "Client" %}:</span> {{ object.client.name }}</p>
            <br>
            <p id="status" class="data"><span class="label label-default">{{ object.get_status_display }}</span></p>
        </div>
    </div>

    <h2 class="section_title">
        Services
    </h2>

    <hr>    

    <div ng-app="quote" ng-controller="glFormController"
         ng-init="init('{% firstof language LANGUAGE_CODE %}', '{{ csrf_token }}')">
        <div qt-quote-form quote-id="{{ object.pk }}" quote="object" endpoint="objectEndpoint"
             language="currentLanguage" forms="forms"
             client-id="{{ client.id }}" project-id="{{ project.id }}" quote-id="{{ quote.id }}"
             template-id="{{ template_id }}">
        </div> 

        <div id="form_actions">
          <div class="row">
              <div class="col-lg-12">
                  <div class="form-actions">
                      {% block form_actions %}
                          <button id="create_submit" class="btn btn-default pull-left" type="submit"
                                  ng-click="submitForm()">
                              {{ submit_text|default:_("Save") }}
                          </button>
                      {% endblock %}
                  </div>
              </div>
          </div>
          </div>

    </div>



{% endblock %}