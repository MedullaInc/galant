<h2 class="center_title">
    Quote
    <span class="pull-right glyphicon glyphicon-question-sign help-tooltip" uib-tooltip="Aids in communicating to your client what you will deliver and how much it will cost." tooltip-placement="top-right"></span>
</h2>

<div class="row">
    <div class="col-lg-10 col-md-10 col-sm-9 col-xs-9">
        <form editable-form name="quoteform" shown="quote && !quote.name"
              onshow="storeQuote()" oncancel="loadStoredQuote()" onaftersave="submitForm()"></form>

        <h2 e-class="form-control" e-id="quote_name" editable-text="quote.name" class="section_title" e-form="quoteform"
            e-placeholder="Enter quote name" onbeforesave="validate.nonEmpty($data)">Name:
            {{ quote.name || quote.errors.name || "empty" }}  </h2>
    </div>

    <div class="col-lg-2 col-md-2 col-sm-3 col-xs-3">
        <div class="affix affix-top" gl-edit-buttons form="quoteform" hide="!showEdit()" delete="deleteObject()('quote')"
             prefix="quote" hide-cancel="hideCancel()">
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-6" ng-show="showClient()">
        <p e-class="form-control" e-name="client" class="data" editable-select="quote.client"
           e-form="quoteform" editable-placeholder="Choose client..." onbeforesave="validate.selectedIf($data, boolTemplate == 'False')"
           e-ng-options="s.id as s.name for s in clients"><span class="detail_title">Client</span>
            <a href="{{ quote.client_link }}">{{ quote.client_name }}</a>
            <br/><br/>
        </p>
    </div>
</div>
<div class="row">
    <div class="col-lg-12">
        <br/>
        <span ng-show="showViews()">
            <span class="label label-default" uib-tooltip="Client Views" tooltip-placement="right">Viewed {{ quote.views }} times</span>
            <span class="label label-default" uib-tooltip="Time spent viewing" tooltip-placement="right">for {{ quote.session_duration }}s</span>
        </span>
    </div>
</div>
<br/>
<br/>

<div class="row">
    <script type="text/ng-template" id="translationTemplate.html">
        <select id="id_language" class="form-control" ng-model="language"
                ng-options="key as val for (key, val) in quoteLanguage"></select>
        <button ng-click="addLanguage(language)" id="language_add" type="button" class="btn btn-default">Add</button>
    </script>

    <script type="text/ng-template" id="languageForm.html">
        <gl-language-form></gl-language-form>
    </script>

    <div ng-show="boolTemplate == 'True'" class="col-lg-12">
        <ul id="tabs" class="nav nav-tabs" style="margin-bottom: -1px; border-bottom: 0">
            <li ng-repeat="lang in quoteTemplate.languages"
                data="{{ lang.code }}">
                <a id="{{ lang.code }}_tab" ng-click="setLanguage(lang.code)">
                    {{ lang.name }}
                </a>
            </li>
            <li id="add_translation">
                <a class="btn" id="add_translation_button"
                   popover-placement="bottom" uib-popover-template="'languageForm.html'" popover-trigger="outsideClick">Add Translation
                </a>
            </li>
        </ul>
    </div>

    <div qt-service-table class="container col-lg-10"></div>

    <div qt-section-table class="container col-lg-10"></div>

    <div class="row" ng-show="showEdit()">
        <div class="col-lg-12">
            <button type="button" id="add_service" class="btn btn-default pull-right margin-left-10"
                    popover-placement="bottom" uib-popover-template="dynamicPopover.serviceTemplateUrl"
                    popover-trigger="focus">Add Service
            </button>

            <button type="button" id="add_section" class="btn btn-default pull-right" ng-click="addSection()">Add
                Section
            </button>
        </div>
    </div>

    <script type="text/ng-template" id="serviceTemplate.html">
        <a ng-click="open()">
            <button id="service_from_template" type="button" class="btn btn-default from_scratch_button sidebar">From
                Template
            </button>
        </a>
        <a ng-click="addService()">
            <button id="service_from_scratch" type="button" class="btn btn-default from_scratch_button sidebar">From
                Scratch
            </button>
        </a>
    </script>

    <script type="text/ng-template" id="myModalContent.html">
        <div class="modal-header">
            <h2 class="section_title">Select a Service</h2>
        </div>
        <div class="modal-body">
            <table st-table="templates" st-safe-src="quoteTemplates" class="table table-striped table-bordered">
                <thead>
                <tr>
                    <th st-sort="name">Name</th>
                    <th st-sort="quantity">Quantity</th>
                    <th st-sort="language">Type</th>
                    <th st-sort="language">Unit Price</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="service in services" ng-click="addService(service)" style="cursor: pointer">
                    <td>{{ service.name[language] }}</td>
                    <td>{{ service.quantity }}</td>
                    <td>{{ showType(service) }}</td>
                    <td>{{ service.cost.amount }}</td>
                </tr>
                <tr ng-if="services.y == 0">
                    <td colspan="4">
                        No services yet.
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </script>
</div>

