{% extends "base_body.html" %}

{% load bootstrap i18n static %}

{% block project_css %}
    {{ block.super }}

    <style>
        .alert {
            margin-top: 110px;
            margin-bottom: -105px;
        }
    </style>
{% endblock %}

{% block header_class %} class="header-5 header-fixed" {% endblock %}

{% if not user.is_authenticated %}
    {% block navbar %}
        <nav class="navbar">
            <div class="col-lg-8 col-md-10 col-sm-10 col-xs-8">
                <div class="navbar-header">
                    <a class="brand" href="/">{{ site.name }} <span>Beta</span></a>
                </div>
            </div>
            <div class="col-lg-4 col-md-2 col-sm-2 col-xs-4">
                <ul class="nav pull-right" id="dropdown-menu">
                    <li class="dropdown-menu-element">
                        <button id="login_open" type="button" class="btn btn-default"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                                id="settings-toggle">
                            {% trans 'Log in' %}
                        </button>
                    </li>
                </ul>
            </div>

        </nav>
    {% endblock %}
{% endif %}

{% block head_title %}
    Manage clients, projects, and money.
{% endblock %}

{% block body %}
    <div id="login_popover" class="popover container" style="display: none">
        <form class="form login_popover" method="POST" action="{% url 'account_login' %}">
            {% csrf_token %}
            <div class="row">
                <div class="col-lg-12">
                    <input autofocus="autofocus" class="form-control" placeholder="Email"
                           type="email" value="" id="id_login" name="login"/>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <input autocomplete="off" class="form-control" placeholder="{% trans 'Password' %}"
                           type="password" id="id_password" name="password"/>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <button type="submit" class="btn btn-default btn-submit" name="submit_login">
                        {% trans 'Log in' %}
                    </button>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <a class="forgot pull-right" href="{% url 'account_reset_password' %}">
                        {% trans 'Forgot your password?' %}</a>
                </div>
            </div>
        </form>
    </div>
    {{ block.super }}
{% endblock %}

{% block content_div %}
    <div class="landing_content">
        {% block content %}
        {% endblock %}
    </div>
{% endblock %}


{% block extra_body %}
    <script>
        jQuery(document).ready(function ($) {
            $('#login_open').popover({
                html: true,
                container: 'body',
                content: $('#login_popover').html(),
                title: false,
                placement: "bottom"
            });

            $('body').on('click', function (e) {
                var p = $('#login_open');
                if (!p.is(e.target) && p.has(e.target).length === 0 && $('.popover').has(e.target).length === 0) {
                    p.popover('hide');
                }
            });

            $(window).resize(function () {
                $('#login_popover').popover('hide');
            });
        });
    </script>
{% endblock %}
